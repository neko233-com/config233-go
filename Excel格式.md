# Excel 配置格式说明

本项目支持的 Excel 配置格式如下（基于 1-based 行号）：

| 行号 | 内容类型 | 说明 |
| :--- | :--- | :--- |
| 第 1 行 | 注释 (Comment) | 字段的中文描述或说明信息 |
| 第 2 行 | 中文字段名 | 中文字段名称（可选，供人类阅读） |
| 第 3 行 | 客户端字段名 (Client) | 客户端使用的字段名 |
| 第 4 行 | 类型 (Type) | 字段数据类型（如 long, string, int, bool 等） |
| 第 5 行 | 服务端字段名 (Server) | **核心：** 映射到 Go Struct 的字段名或 Map 的 Key |
| 第 6+ 行 | 数据 (Data) | 具体的配置数据内容 |

## 重要说明

- **第 1 列**：是标识列（如 "注释", "Client", "type", "Server" 等），**不作为字段名**，会被跳过
- **第 5 行（索引 4）**：作为服务端字段名的来源
- **第 6 行（索引 5）**：开始读取实际数据
- **空字段名**：如果字段名为空，该列将被跳过

## 示例

| 标识列 | 物品id | 物品名称 | 备注 | 物品描述信息 | 背包分组 | 道具类型 | 过期毫秒数 | 道具品质 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **注释** | 物品id | 物品名称 | 备注 | 物品描述信息 | 背包分组 | 道具类型 | 过期毫秒数 | 道具品质 |
| **Client** | itemId | itemName | | desc | bagType | type | expireTimeMs | quality |
| **type** | long | string | string | string | string | int | long | int |
| **Server** | itemId | itemName | | desc | bagType | type | expireTimeMs | quality |
| **(数据)** | 1 | demo | | xxx | item | 1 | | 1 |
| **(数据)** | 2 | demo232345 | | | | | | |

## 数据读取逻辑

1. 程序会自动读取第一个 Working Sheet（工作表）
2. 跳过第 1 列（标识列）
3. 从第 2 列开始，使用第 5 行（Server 行）的值作为字段名
4. 从第 6 行开始读取数据行
5. 空字段名和空数据会被自动跳过

## 代码层面的索引

```go
// 0-based 索引
rows[0]  // 第 1 行：注释
rows[1]  // 第 2 行：中文字段名
rows[2]  // 第 3 行：Client 字段名
rows[3]  // 第 4 行：类型
rows[4]  // 第 5 行：Server 字段名 ← 使用这一行的 [1:] 作为字段名
rows[5:] // 第 6 行开始：数据行
```

